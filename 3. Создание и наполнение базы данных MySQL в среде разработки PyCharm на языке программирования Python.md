# 3. Создание и наполнение базы данных MySQL в среде разработки PyCharm на языке программирования Python.

## 3.1 Создание базы данных MySQL.

Данные базы находятся в CSV файлах. Для того, чтобы импортировать их в базу данных MySQL можно воспользоваться языком 
программирования Python.
Для начала загрузки необходимо создать базу данных.
Воспользуемся популярным стандартом протокола MySQL для Python PyMySQL. Данный протокол обеспечивает доступ к системе управления 
базами данных MySQL из приложений написанных на языке программирования Python.

Следующий код создает подключение к серверу MySQL с помощью метода connect(), отправляет запрос на создание новой базы данных с 
помощью метода execute(), а затем закрывает подключение к серверу с помощью метода close().
Существует несколько типов курсоров, доступных через Pymysql. Здесь использован DictCursor, для того, чтобы результат запроса 
был в виде словаря.

```import pymysql

host = '127.0.0.1'
user = 'root'
password = '********'

try:
    connection = pymysql.connect(
        host=host,
        port=3306,
        user=user,
        password=password,
        cursorclass=pymysql.cursors.DictCursor
    )
    print("successfully connected...")
    print("#" * 20)

    try:
        # create table
        with connection.cursor() as cursor:
            create_database_query = '''CREATE DATABASE IF NOT EXISTS diploma;'''
            cursor.execute(create_database_query)
            print("DataBase is created successfully")
    finally:
        connection.close()

except Exception as ex:
    print("Connection refused...")
    print(ex)

```


```
import pymysql

host = '127.0.0.1'
user = 'root'
password = '********'
db_name = 'diploma'

try:
    connection = pymysql.connect(
        host=host,
        port=3306,
        user=user,
        password=password,
        database=db_name,
        cursorclass=pymysql.cursors.DictCursor
    )
    print("successfully connected...")
    print("#" * 20)

    try:
        # create table
        with connection.cursor() as cursor:
            create_table_query = '''CREATE TABLE IF NOT EXISTS `DIPLOMA`.`stat_citizens` (
  `region_code` VARCHAR(25) NULL COMMENT 'Код региона\n',
  `region_name` VARCHAR(45) NULL COMMENT 'Наименование региона (на русском)\n',
  `cvs_count` VARCHAR(15) NULL COMMENT 'Количество резюме',
  `medium_salary` VARCHAR(15) NULL COMMENT 'Средняя заработная плата\n',
  `region_code_mistake` VARCHAR(5) NULL COMMENT 'Ошибки в датах атрибута region_code (длина не 13 цифр)');'''
            cursor.execute(create_table_query)
            print("Table created successfully")
    finally:
        connection.close()

except Exception as ex:
    print("Connection refused...")
    print(ex)

```

3.2 Основной скрипт построчной загрузки больших данных.

3.3 Типы данных MySQL.

3.4 PRIMARY KEY.

3.5 Изменение формата даты и регулярные выражения.

3.6 Дубликаты строк в таблицах.

3.7 Индекс как средство увеличения производительности в работе с БД.
